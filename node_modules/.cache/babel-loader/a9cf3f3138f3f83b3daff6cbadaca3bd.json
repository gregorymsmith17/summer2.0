{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.GRIDDLE_INITIALIZED = GRIDDLE_INITIALIZED;\nexports.GRIDDLE_LOADED_DATA = GRIDDLE_LOADED_DATA;\nexports.GRIDDLE_SET_PAGE_SIZE = GRIDDLE_SET_PAGE_SIZE;\nexports.GRIDDLE_SET_PAGE = GRIDDLE_SET_PAGE;\nexports.GRIDDLE_SET_FILTER = GRIDDLE_SET_FILTER;\nexports.GRIDDLE_SET_SORT = GRIDDLE_SET_SORT;\nexports.GRIDDLE_TOGGLE_SETTINGS = GRIDDLE_TOGGLE_SETTINGS;\nexports.GRIDDLE_TOGGLE_COLUMN = GRIDDLE_TOGGLE_COLUMN;\nexports.GRIDDLE_UPDATE_STATE = GRIDDLE_UPDATE_STATE;\n\nvar _immutable = require('immutable');\n\nvar _immutable2 = _interopRequireDefault(_immutable);\n\nvar _dataUtils = require('../utils/dataUtils');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n/*\n * State\n * ------------------\n *  data {Immutable.List} - the data that the grid is displaying\n *  loading {boolean} - is the data currently loading\n *  renderProperties {Immutable.Map} - the properties that determine how the grid should be displayed\n *  pageProperties {Immutable.Map} - the metadata for paging information\n *  .-- currentPage {int} - The current, visible page\n *  .-- pageSize {int} - The number of records to display\n *  sortProperties {Immutable.List} - the metadata surrounding sort\n *  .-- id {string} - the column id\n *  .-- sortAscending {boolean} - the direction of the sort. Index matches that of sortColumns\n **/\n\n\nfunction isColumnVisible(state, columnId) {\n  var hasRenderProperty = state.getIn(['renderProperties', 'columnProperties', columnId]);\n  var currentlyVisibleProperty = state.getIn(['renderProperties', 'columnProperties', columnId, 'visible']); // if there is a render property and visible is not set, visible is true\n\n  if (hasRenderProperty && currentlyVisibleProperty === undefined) {\n    return true;\n  } // if there is no render property currently and visible is not set\n\n\n  if (!hasRenderProperty && currentlyVisibleProperty === undefined) {\n    return false;\n  }\n\n  return currentlyVisibleProperty;\n}\n/** Sets the default render properties\n * @param {Immutable} state- Immutable previous state object\n * @param {Object} action - The action object to work with\n *\n * TODO: Consider renaming this to be more in line with what it's actually doing (setting render properties)\n*/\n\n\nfunction GRIDDLE_INITIALIZED(initialState) {\n  var tempState = Object.assign({}, initialState);\n  tempState = (0, _dataUtils.addColumnPropertiesWhenNoneExist)(tempState); //TODO: could probably make this more efficient by removing data\n  // making the rest of the properties initial state and\n  // setting the mapped data on the new initial state immutable object\n\n  if (initialState.data && initialState.data.length > 0) {\n    var transformedData = (0, _dataUtils.transformData)(initialState.data, initialState.renderProperties);\n    tempState.data = transformedData.data;\n    tempState.lookup = transformedData.lookup;\n  }\n\n  return _immutable2.default.fromJS(tempState);\n}\n/** Sets the griddle data\n * @param {Immutable} state- Immutable previous state object\n * @param {Object} action - The action object to work with\n*/\n\n\nfunction GRIDDLE_LOADED_DATA(state, action) {\n  var transformedData = (0, _dataUtils.transformData)(action.data, state.get('renderProperties').toJSON());\n  return state.set('data', transformedData.data).set('lookup', transformedData.lookup).set('loading', false);\n}\n/** Sets the current page size\n * @param {Immutable} state- Immutable previous state object\n * @param {Object} action - The action object to work with\n*/\n\n\nfunction GRIDDLE_SET_PAGE_SIZE(state, action) {\n  return state.setIn(['pageProperties', 'currentPage'], 1).setIn(['pageProperties', 'pageSize'], action.pageSize);\n}\n/** Sets the current page\n * @param {Immutable} state- Immutable previous state object\n * @param {Object} action - The action object to work with\n*/\n\n\nfunction GRIDDLE_SET_PAGE(state, action) {\n  return state.setIn(['pageProperties', 'currentPage'], action.pageNumber);\n}\n/** Sets the filter\n * @param {Immutable} state- Immutable previous state object\n * @param {Object} action - The action object to work with\n*/\n\n\nfunction GRIDDLE_SET_FILTER(state, action) {\n  return state.set('filter', action.filter);\n}\n/** Sets sort properties\n * @param {Immutable} state- Immutable previous state object\n * @param {Object} action - The action object to work with\n*/\n\n\nfunction GRIDDLE_SET_SORT(state, action) {\n  // turn this into an array if it's not already\n  var sortProperties = action.sortProperties.hasOwnProperty('length') ? action.sortProperties : [action.sortProperties];\n  return state.set('sortProperties', new _immutable2.default.fromJS(sortProperties));\n}\n/** Sets the settings visibility to true / false depending on the current property\n */\n\n\nfunction GRIDDLE_TOGGLE_SETTINGS(state, action) {\n  // if undefined treat as if it's false\n  var showSettings = state.get('showSettings') || false;\n  return state.set('showSettings', !showSettings);\n}\n\nfunction GRIDDLE_TOGGLE_COLUMN(state, action) {\n  // flips the visible state if the column property exists\n  var currentlyVisible = isColumnVisible(state, action.columnId);\n  return state.getIn(['renderProperties', 'columnProperties', action.columnId]) ? state.setIn(['renderProperties', 'columnProperties', action.columnId, 'visible'], !currentlyVisible) : // if the columnProperty doesn't exist, create a new one and set the property to true\n  state.setIn(['renderProperties', 'columnProperties', action.columnId], new _immutable2.default.Map({\n    id: action.columnId,\n    visible: true\n  }));\n}\n\nvar defaultRenderProperties = _immutable2.default.fromJS({});\n\nfunction GRIDDLE_UPDATE_STATE(state, action) {\n  var _action$newState = action.newState,\n      data = _action$newState.data,\n      newState = _objectWithoutProperties(_action$newState, ['data']);\n\n  var mergedState = state.mergeDeep(_immutable2.default.fromJS(newState));\n\n  if (!data) {\n    return mergedState;\n  }\n\n  var renderProperties = state.get('renderProperties', defaultRenderProperties).toJSON();\n  var transformedData = (0, _dataUtils.transformData)(data, renderProperties);\n  return mergedState.set('data', transformedData.data).set('lookup', transformedData.lookup);\n}","map":null,"metadata":{},"sourceType":"script"}